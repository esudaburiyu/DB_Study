#トランザクションとは?
トランザクションとは、処理の単位

#ACID特性とは?
ACID特性には

- Atomic特性
- Consistency特性
- Isocaration特性
- Durability特性

の４つがある。

##Atomic特性

トランザクションに含まれるタスクが、全て実行されるか、あるいは全く実行されないかのいずれかである、ということを保証する。
原子とは、分割できないということ。
別に、ほかのトランザクションとの関係性について何か言ってるわけじゃない。
具体的には、commitされるかRollbackされるかのいずれかだ、ということだろう

##Consistency特性

一貫性、あるいは整合性のこと。
######これって、DBMS的には、具体的に何を保証するの?
createテーブルのときにつけた制約を守らせるとか。

## Isolation特性

トランザクション中に行われる操作の過程が他の操作から隠蔽されること。
同時に複数のトランザクションを行っても、順次実行した時の結果と変わらない、くらいの意味か?

詳しくは、**トランザクションの分離レベル**のところでやる。

######これって、A をしてBをする、ということと、BをしてAをする、ということが等しい、ということを保証するのか?

## Durability特性

永続性。トランザクションの結果が失われないこと。
DBMSが、耐障害性を保証する、くらいの理解でいい。

######ぶっちゃけ、Atomic特性以外、よくわからんぞ……

######Durability特性は、耐障害性だ、ということで理解。

######Consistency特性と、Isolation特性の違い

#トランザクションの分離レベル
トランザクションの分離レベルには

- READ UNCOMMITTED
- READ COMMITTED
- REPEATABLE READ
- SERIALIZABLE

の４つがある。分離レベルが上がれば、トランザクションの独立性は高まっていくが、そのかわり、並列実行の性能が落ちていく。

- [トランザクション分離レベルについて極力分かりやすく解説してみた[SQL]](http://gyouza-daisuki.hatenablog.com/entry/2013/11/19/150838)
- [DBの「トランザクション分離レベル」が必要な理由](http://d.hatena.ne.jp/language_and_engineering/20110104/p1)
- [ファントムリードってなんだろう](http://okwakatta.net/topic/topic031.html)

######ダーティリードとアンリピータブルリードの問題点は、比較的わかりやすい。
######ファントムリードの問題点はちょっとわかりづらい。

## READ UNCOMMITTED

他のトランザクションで処理されている、コミットされていないデータを読み取ることを許す。変更途中のデータ読み取りをダーティリードという。どういうことか。

例えば、トランザクションAの途中でxの値を変更する。トランザクションBは、Aがコミットされる前に、Aで変更されたあとのxの値を読み取ることができる。しかし、Aはコミット前なので、どこかで問題が起こって結局ロールバックしてしまうかもしれない。そうすると、Bが読んだデータは不正なデータということになってしまう。

## READ COMMITTED

コミットされたデータのみを読み取るように制限する。これにより、ダーティリードはおこらなくなる。しかし、**アンリピータブルリード**が起こりうる。どういうことか

例えば、トランザクションAの途中で、2度データxを読み取るとする。このとき、一度目の読み取りと二度目の読み取りの間に、xを変更するトランザクションがコミットされると、一度目と二度目の読み取りで、xの値が違ってしまう。このようなことを**アンリピータブルリード**という

## REPEATABLE READ

一つのトランザクションの間では、データを読み取るとき、何度読みだしても同じ値になるようにする。これにより、アンリピータブルリードは起こらなくなる。

しかし、ファントムリードは起こりうる。ファントムリードとは、あるトランザクションの実行中に、新たに現れるデータを読み取ってしまうこと。これは、読み取るたびに値が違う、ということではない。では、ファントムリードは何がまずいのか?

## SERIALIZABLE

必ず直列可能性が満たされるように、トランザクションを同時実行制御する。ダーティリード、アンリピータブルリード、ファントムリード

##ファントムリードとアンリピータブルリードの違い
ファントムリードは、トランザクションの途中で現れるデータを読むこと。
アンリピータブルリードとは、同じトランザクションのなかで、同じデータを読んだ時に、一度目と二度目て値が違うということ。

##ファントムリードってどうやって防ぐの?
 トランザクションの開始時点で、トランザクションの中でアクセスするデータを全て記録しておけばできる?
 でも、重たい処理だと難しくないか? MySQLではどうやって実現してるの?

#発展的な話題
[クラウド時代のトランザクション](http://labo.mamezou.com/special/sp_001/sp_001_005.html)

